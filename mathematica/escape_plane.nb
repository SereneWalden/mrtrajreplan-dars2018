(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     87254,       1545]
NotebookOptionsPosition[     86321,       1522]
NotebookOutlinePosition[     86660,       1537]
CellTagsIndexPosition[     86617,       1534]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"d", " ", "=", " ", "7"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"pd", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", "t_", "]"}], " ", "=", " ", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"P", "[", 
             RowBox[{"i", ",", "j"}], "]"}], "*", 
            RowBox[{"Binomial", "[", 
             RowBox[{"d", ",", "i"}], "]"}], "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"t", "/", "dur"}], ")"}], "^", "i"}], "*", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{"t", "/", "dur"}], ")"}]}], ")"}], "^", 
             RowBox[{"(", 
              RowBox[{"d", "-", "i"}], ")"}]}]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", "0", ",", " ", "d"}], "}"}]}], "]"}], ",", 
         " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"pd", "-", "1"}]}], "}"}]}], "]"}], ",", " ", "0"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"planenormal", " ", "=", " ", 
     RowBox[{"Append", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"n", "[", "i", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", 
           RowBox[{"pd", "-", "1"}]}], "}"}]}], "]"}], ",", " ", "0"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dist", " ", "=", " ", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{"planenormal", ",", " ", 
        RowBox[{"f", "[", "t", "]"}]}], "]"}], "-", "planedist"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"velonplane", " ", "=", " ", 
      RowBox[{"Cross", "[", 
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{"planenormal", ",", " ", 
          RowBox[{
           RowBox[{"f", "'"}], "[", "t", "]"}]}], "]"}], ",", " ", 
        "planenormal"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"velocityprojectedtoplane", " ", "=", " ", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"velonplane", ".", "velonplane"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cost", " ", "=", " ", 
      RowBox[{"dist", " ", "*", " ", "velocityprojectedtoplane"}]}], ";"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vel", " ", "=", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f", "'"}], "[", "t", "]"}], ".", 
       RowBox[{
        RowBox[{"f", "'"}], "[", "t", "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cost", " ", "=", " ", 
     RowBox[{"dist", " ", "*", " ", "vel"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gradtoescape", " ", "=", " ", 
     RowBox[{"Grad", "[", 
      RowBox[{"cost", ",", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"P", "[", 
           RowBox[{"i", ",", "j"}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "d"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{"pd", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.729543626873891*^9, 3.72954363002203*^9}, {
   3.7295441782033873`*^9, 3.729544252194613*^9}, {3.729544358631076*^9, 
   3.7295444068434153`*^9}, {3.7295494267878838`*^9, 3.729549431898876*^9}, {
   3.729549596423238*^9, 3.729549656273821*^9}, {3.7295497719958553`*^9, 
   3.729549779988681*^9}, {3.730747957082904*^9, 3.730747964270142*^9}, {
   3.73237941830781*^9, 3.732379436698737*^9}, {3.732379504953611*^9, 
   3.7323795543450413`*^9}, {3.732379605481162*^9, 3.7323796942407627`*^9}, {
   3.732379764622937*^9, 3.732379797247731*^9}, {3.732379856744191*^9, 
   3.732379867757139*^9}, {3.732379912075276*^9, 3.732379959332795*^9}, {
   3.733079011486855*^9, 3.733079061541141*^9}, {3.733079093719459*^9, 
   3.733079137992465*^9}, 3.733079197332429*^9, {3.733079228841551*^9, 
   3.733079230572298*^9}},ExpressionUUID->"6e7b734a-c010-42be-b5a8-\
2506c720815f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CForm", "[", "cost", "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.7295496640545588`*^9, 3.730747987077346*^9, {3.7323115997691927`*^9, 
   3.7323116126780863`*^9}, {3.732379635625671*^9, 3.7323796359787617`*^9}, 
   3.733079200492936*^9, {3.7330795501363297`*^9, 
   3.733079557460268*^9}},ExpressionUUID->"a2dca779-c917-4122-a23b-\
bab17a16250b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{"0", ",", "0"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"0", ",", "1"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"1", ",", "0"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"1", ",", "1"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"2", ",", "0"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"2", ",", "1"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"3", ",", "0"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"3", ",", "1"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"4", ",", "0"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"4", ",", "1"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"5", ",", "0"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"5", ",", "1"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"6", ",", "0"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"6", ",", "1"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"7", ",", "0"}], "]"}], ",", 
   RowBox[{"P", "[", 
    RowBox[{"7", ",", "1"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.733079260358235*^9, 
  3.733079553807001*^9},ExpressionUUID->"285aaf29-2eb7-4411-b2aa-\
6e583ba1600e"],

Cell["\<\
Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
       (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
       (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
       (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7),2) + 
     Power((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
       (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
       (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
       (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7),2))*
   (-planedist + n(0)*(Power(1 - t/dur,7)*P(0,0) + (7*t*Power(1 - \
t/dur,6)*P(1,0))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + 
        (35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (Power(t,7)*P(7,0))/Power(dur,7))\\
      + n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - t/dur,6)*P(1,1))/dur \
+ (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) + \
(35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
        (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (Power(t,7)*P(7,1))/Power(dur,7)))\
\>", "Output",
 CellChangeTimes->{3.733079260358235*^9, 
  3.733079553809279*^9},ExpressionUUID->"2d6b5ac4-9f0d-4d9d-82dd-\
4c402397ea3d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"CForm", "[", "gradtoescape", "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7323798065316477`*^9, 3.732379807129345*^9}, {
  3.7330794555638313`*^9, 
  3.7330794605208683`*^9}},ExpressionUUID->"5fff85ca-afc2-4399-8a6d-\
e04227a86ba0"],

Cell["\<\
List(Power(1 - t/dur,7)*n(0)*Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - \
(42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - \
t/dur,6)*P(1,0))/dur - 
         (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
         (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
         (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
         (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
         (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
         (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
         (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
         (7*Power(t,6)*P(7,1))/Power(dur,7),2)) - (7*Power(1 - \
t/dur,6)*((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - 
         (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
         (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
         (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
         (7*Power(t,6)*P(7,0))/Power(dur,7))*(-planedist + n(0)*(Power(1 - \
t/dur,7)*P(0,0) + (7*t*Power(1 - t/dur,6)*P(1,0))/dur + \
(21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) + 
            (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + \
(35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + 
            (7*Power(t,6)*(1 - t/dur)*P(6,0))/Power(dur,6) + \
(Power(t,7)*P(7,0))/Power(dur,7)) + 
         n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - \
t/dur,6)*P(1,1))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
            (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
            (Power(t,7)*P(7,1))/Power(dur,7))))/
     (dur*Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
           (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
           (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
           (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7),2) + 
         Power((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
           (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
           (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
           (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7),2))),
   Power(1 - t/dur,7)*n(1)*Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - \
(42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - \
t/dur,6)*P(1,0))/dur - 
         (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
         (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
         (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
         (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
         (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
         (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
         (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
         (7*Power(t,6)*P(7,1))/Power(dur,7),2)) - (7*Power(1 - \
t/dur,6)*((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - 
         (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
         (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
         (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
         (7*Power(t,6)*P(7,1))/Power(dur,7))*(-planedist + n(0)*(Power(1 - \
t/dur,7)*P(0,0) + (7*t*Power(1 - t/dur,6)*P(1,0))/dur + \
(21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) + 
            (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + \
(35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + 
            (7*Power(t,6)*(1 - t/dur)*P(6,0))/Power(dur,6) + \
(Power(t,7)*P(7,0))/Power(dur,7)) + 
         n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - \
t/dur,6)*P(1,1))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
            (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
            (Power(t,7)*P(7,1))/Power(dur,7))))/
     (dur*Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
           (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
           (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
           (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7),2) + 
         Power((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
           (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
           (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
           (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7),2))),
   (7*t*Power(1 - t/dur,6)*n(0)*Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur \
- (42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - \
t/dur,6)*P(1,0))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
           (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
           (7*Power(t,6)*P(7,1))/Power(dur,7),2)))/dur + (((-42*t*Power(1 - \
t/dur,5))/Power(dur,2) + (7*Power(1 - t/dur,6))/dur)*
       ((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7))*
       (-planedist + n(0)*(Power(1 - t/dur,7)*P(0,0) + (7*t*Power(1 - \
t/dur,6)*P(1,0))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) \
+ 
            (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + \
(35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + 
            (7*Power(t,6)*(1 - t/dur)*P(6,0))/Power(dur,6) + \
(Power(t,7)*P(7,0))/Power(dur,7)) + 
         n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - \
t/dur,6)*P(1,1))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
            (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
            (Power(t,7)*P(7,1))/Power(dur,7))))/
     Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7),2) + 
       Power((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7),2)),
   (7*t*Power(1 - t/dur,6)*n(1)*Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur \
- (42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - \
t/dur,6)*P(1,0))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
           (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
           (7*Power(t,6)*P(7,1))/Power(dur,7),2)))/dur + (((-42*t*Power(1 - \
t/dur,5))/Power(dur,2) + (7*Power(1 - t/dur,6))/dur)*
       ((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7))*
       (-planedist + n(0)*(Power(1 - t/dur,7)*P(0,0) + (7*t*Power(1 - \
t/dur,6)*P(1,0))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) \
+ 
            (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + \
(35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + 
            (7*Power(t,6)*(1 - t/dur)*P(6,0))/Power(dur,6) + \
(Power(t,7)*P(7,0))/Power(dur,7)) + 
         n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - \
t/dur,6)*P(1,1))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
            (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
            (Power(t,7)*P(7,1))/Power(dur,7))))/
     Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7),2) + 
       Power((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7),2)),
   (21*Power(t,2)*Power(1 - t/dur,5)*n(0)*Sqrt(Power((-7*Power(1 - \
t/dur,6)*P(0,0))/dur - (42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,0))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
           (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
           (7*Power(t,6)*P(7,1))/Power(dur,7),2)))/Power(dur,2) + \
(((-105*Power(t,2)*Power(1 - t/dur,4))/Power(dur,3) + (42*t*Power(1 - \
t/dur,5))/Power(dur,2))*
       ((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7))*
       (-planedist + n(0)*(Power(1 - t/dur,7)*P(0,0) + (7*t*Power(1 - \
t/dur,6)*P(1,0))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) \
+ 
            (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + \
(35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + 
            (7*Power(t,6)*(1 - t/dur)*P(6,0))/Power(dur,6) + \
(Power(t,7)*P(7,0))/Power(dur,7)) + 
         n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - \
t/dur,6)*P(1,1))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
            (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
            (Power(t,7)*P(7,1))/Power(dur,7))))/
     Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7),2) + 
       Power((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7),2)),
   (21*Power(t,2)*Power(1 - t/dur,5)*n(1)*Sqrt(Power((-7*Power(1 - \
t/dur,6)*P(0,0))/dur - (42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,0))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
           (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
           (7*Power(t,6)*P(7,1))/Power(dur,7),2)))/Power(dur,2) + \
(((-105*Power(t,2)*Power(1 - t/dur,4))/Power(dur,3) + (42*t*Power(1 - \
t/dur,5))/Power(dur,2))*
       ((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7))*
       (-planedist + n(0)*(Power(1 - t/dur,7)*P(0,0) + (7*t*Power(1 - \
t/dur,6)*P(1,0))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) \
+ 
            (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + \
(35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + 
            (7*Power(t,6)*(1 - t/dur)*P(6,0))/Power(dur,6) + \
(Power(t,7)*P(7,0))/Power(dur,7)) + 
         n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - \
t/dur,6)*P(1,1))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
            (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
            (Power(t,7)*P(7,1))/Power(dur,7))))/
     Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7),2) + 
       Power((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7),2)),
   (35*Power(t,3)*Power(1 - t/dur,4)*n(0)*Sqrt(Power((-7*Power(1 - \
t/dur,6)*P(0,0))/dur - (42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,0))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
           (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
           (7*Power(t,6)*P(7,1))/Power(dur,7),2)))/Power(dur,3) + \
(((-140*Power(t,3)*Power(1 - t/dur,3))/Power(dur,4) + (105*Power(t,2)*Power(1 \
- t/dur,4))/Power(dur,3))*
       ((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7))*
       (-planedist + n(0)*(Power(1 - t/dur,7)*P(0,0) + (7*t*Power(1 - \
t/dur,6)*P(1,0))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) \
+ 
            (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + \
(35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + 
            (7*Power(t,6)*(1 - t/dur)*P(6,0))/Power(dur,6) + \
(Power(t,7)*P(7,0))/Power(dur,7)) + 
         n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - \
t/dur,6)*P(1,1))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
            (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
            (Power(t,7)*P(7,1))/Power(dur,7))))/
     Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7),2) + 
       Power((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7),2)),
   (35*Power(t,3)*Power(1 - t/dur,4)*n(1)*Sqrt(Power((-7*Power(1 - \
t/dur,6)*P(0,0))/dur - (42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,0))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
           (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
           (7*Power(t,6)*P(7,1))/Power(dur,7),2)))/Power(dur,3) + \
(((-140*Power(t,3)*Power(1 - t/dur,3))/Power(dur,4) + (105*Power(t,2)*Power(1 \
- t/dur,4))/Power(dur,3))*
       ((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7))*
       (-planedist + n(0)*(Power(1 - t/dur,7)*P(0,0) + (7*t*Power(1 - \
t/dur,6)*P(1,0))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) \
+ 
            (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + \
(35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + 
            (7*Power(t,6)*(1 - t/dur)*P(6,0))/Power(dur,6) + \
(Power(t,7)*P(7,0))/Power(dur,7)) + 
         n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - \
t/dur,6)*P(1,1))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
            (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
            (Power(t,7)*P(7,1))/Power(dur,7))))/
     Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7),2) + 
       Power((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7),2)),
   (35*Power(t,4)*Power(1 - t/dur,3)*n(0)*Sqrt(Power((-7*Power(1 - \
t/dur,6)*P(0,0))/dur - (42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,0))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
           (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
           (7*Power(t,6)*P(7,1))/Power(dur,7),2)))/Power(dur,4) + \
(((-105*Power(t,4)*Power(1 - t/dur,2))/Power(dur,5) + (140*Power(t,3)*Power(1 \
- t/dur,3))/Power(dur,4))*
       ((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7))*
       (-planedist + n(0)*(Power(1 - t/dur,7)*P(0,0) + (7*t*Power(1 - \
t/dur,6)*P(1,0))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) \
+ 
            (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + \
(35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + 
            (7*Power(t,6)*(1 - t/dur)*P(6,0))/Power(dur,6) + \
(Power(t,7)*P(7,0))/Power(dur,7)) + 
         n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - \
t/dur,6)*P(1,1))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
            (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
            (Power(t,7)*P(7,1))/Power(dur,7))))/
     Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7),2) + 
       Power((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7),2)),
   (35*Power(t,4)*Power(1 - t/dur,3)*n(1)*Sqrt(Power((-7*Power(1 - \
t/dur,6)*P(0,0))/dur - (42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,0))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
           (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
           (7*Power(t,6)*P(7,1))/Power(dur,7),2)))/Power(dur,4) + \
(((-105*Power(t,4)*Power(1 - t/dur,2))/Power(dur,5) + (140*Power(t,3)*Power(1 \
- t/dur,3))/Power(dur,4))*
       ((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7))*
       (-planedist + n(0)*(Power(1 - t/dur,7)*P(0,0) + (7*t*Power(1 - \
t/dur,6)*P(1,0))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) \
+ 
            (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + \
(35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + 
            (7*Power(t,6)*(1 - t/dur)*P(6,0))/Power(dur,6) + \
(Power(t,7)*P(7,0))/Power(dur,7)) + 
         n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - \
t/dur,6)*P(1,1))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
            (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
            (Power(t,7)*P(7,1))/Power(dur,7))))/
     Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7),2) + 
       Power((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7),2)),
   (21*Power(t,5)*Power(1 - t/dur,2)*n(0)*Sqrt(Power((-7*Power(1 - \
t/dur,6)*P(0,0))/dur - (42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,0))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
           (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
           (7*Power(t,6)*P(7,1))/Power(dur,7),2)))/Power(dur,5) + \
(((-42*Power(t,5)*(1 - t/dur))/Power(dur,6) + (105*Power(t,4)*Power(1 - \
t/dur,2))/Power(dur,5))*
       ((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7))*
       (-planedist + n(0)*(Power(1 - t/dur,7)*P(0,0) + (7*t*Power(1 - \
t/dur,6)*P(1,0))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) \
+ 
            (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + \
(35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + 
            (7*Power(t,6)*(1 - t/dur)*P(6,0))/Power(dur,6) + \
(Power(t,7)*P(7,0))/Power(dur,7)) + 
         n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - \
t/dur,6)*P(1,1))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
            (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
            (Power(t,7)*P(7,1))/Power(dur,7))))/
     Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7),2) + 
       Power((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7),2)),
   (21*Power(t,5)*Power(1 - t/dur,2)*n(1)*Sqrt(Power((-7*Power(1 - \
t/dur,6)*P(0,0))/dur - (42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,0))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
           (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
           (7*Power(t,6)*P(7,1))/Power(dur,7),2)))/Power(dur,5) + \
(((-42*Power(t,5)*(1 - t/dur))/Power(dur,6) + (105*Power(t,4)*Power(1 - \
t/dur,2))/Power(dur,5))*
       ((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7))*
       (-planedist + n(0)*(Power(1 - t/dur,7)*P(0,0) + (7*t*Power(1 - \
t/dur,6)*P(1,0))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) \
+ 
            (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + \
(35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + 
            (7*Power(t,6)*(1 - t/dur)*P(6,0))/Power(dur,6) + \
(Power(t,7)*P(7,0))/Power(dur,7)) + 
         n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - \
t/dur,6)*P(1,1))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
            (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
            (Power(t,7)*P(7,1))/Power(dur,7))))/
     Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7),2) + 
       Power((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7),2)),
   (7*Power(t,6)*(1 - t/dur)*n(0)*Sqrt(Power((-7*Power(1 - \
t/dur,6)*P(0,0))/dur - (42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,0))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
           (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
           (7*Power(t,6)*P(7,1))/Power(dur,7),2)))/Power(dur,6) + \
(((-7*Power(t,6))/Power(dur,7) + (42*Power(t,5)*(1 - t/dur))/Power(dur,6))*
       ((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7))*
       (-planedist + n(0)*(Power(1 - t/dur,7)*P(0,0) + (7*t*Power(1 - \
t/dur,6)*P(1,0))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) \
+ 
            (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + \
(35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + 
            (7*Power(t,6)*(1 - t/dur)*P(6,0))/Power(dur,6) + \
(Power(t,7)*P(7,0))/Power(dur,7)) + 
         n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - \
t/dur,6)*P(1,1))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
            (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
            (Power(t,7)*P(7,1))/Power(dur,7))))/
     Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7),2) + 
       Power((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7),2)),
   (7*Power(t,6)*(1 - t/dur)*n(1)*Sqrt(Power((-7*Power(1 - \
t/dur,6)*P(0,0))/dur - (42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,0))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
           (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
           (7*Power(t,6)*P(7,1))/Power(dur,7),2)))/Power(dur,6) + \
(((-7*Power(t,6))/Power(dur,7) + (42*Power(t,5)*(1 - t/dur))/Power(dur,6))*
       ((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7))*
       (-planedist + n(0)*(Power(1 - t/dur,7)*P(0,0) + (7*t*Power(1 - \
t/dur,6)*P(1,0))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) \
+ 
            (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + \
(35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + 
            (7*Power(t,6)*(1 - t/dur)*P(6,0))/Power(dur,6) + \
(Power(t,7)*P(7,0))/Power(dur,7)) + 
         n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - \
t/dur,6)*P(1,1))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
            (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
            (Power(t,7)*P(7,1))/Power(dur,7))))/
     Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,0))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,0))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + (7*Power(t,6)*P(7,0))/Power(dur,7),2) + 
       Power((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - \
(105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + 
         (42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - \
(140*Power(t,3)*Power(1 - t/dur,3)*P(3,1))/Power(dur,4) + \
(105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - (42*Power(t,5)*(1 - \
t/dur)*P(5,1))/Power(dur,6) + 
         (105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + (7*Power(t,6)*P(7,1))/Power(dur,7),2)),
   (Power(t,7)*n(0)*Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - \
(42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - \
t/dur,6)*P(1,0))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
           (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
           (7*Power(t,6)*P(7,1))/Power(dur,7),2)))/Power(dur,7) + \
(7*Power(t,6)*((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - 
         (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
         (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
         (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
         (7*Power(t,6)*P(7,0))/Power(dur,7))*(-planedist + n(0)*(Power(1 - \
t/dur,7)*P(0,0) + (7*t*Power(1 - t/dur,6)*P(1,0))/dur + \
(21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) + 
            (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + \
(35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + 
            (7*Power(t,6)*(1 - t/dur)*P(6,0))/Power(dur,6) + \
(Power(t,7)*P(7,0))/Power(dur,7)) + 
         n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - \
t/dur,6)*P(1,1))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
            (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
            (Power(t,7)*P(7,1))/Power(dur,7))))/
     (Power(dur,7)*Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - \
(42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - \
t/dur,6)*P(1,0))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
           (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
           (7*Power(t,6)*P(7,1))/Power(dur,7),2))),(Power(t,7)*n(1)*Sqrt(\
Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,0))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
           (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
           (7*Power(t,6)*P(7,1))/Power(dur,7),2)))/Power(dur,7) + \
(7*Power(t,6)*((-7*Power(1 - t/dur,6)*P(0,1))/dur - (42*t*Power(1 - \
t/dur,5)*P(1,1))/Power(dur,2) + (7*Power(1 - t/dur,6)*P(1,1))/dur - 
         (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
         (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
         (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
         (7*Power(t,6)*P(7,1))/Power(dur,7))*(-planedist + n(0)*(Power(1 - \
t/dur,7)*P(0,0) + (7*t*Power(1 - t/dur,6)*P(1,0))/dur + \
(21*Power(t,2)*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) + 
            (35*Power(t,3)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) + \
(35*Power(t,4)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) + 
            (7*Power(t,6)*(1 - t/dur)*P(6,0))/Power(dur,6) + \
(Power(t,7)*P(7,0))/Power(dur,7)) + 
         n(1)*(Power(1 - t/dur,7)*P(0,1) + (7*t*Power(1 - \
t/dur,6)*P(1,1))/dur + (21*Power(t,2)*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) \
+ (35*Power(t,3)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) + 
            (35*Power(t,4)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) + \
(21*Power(t,5)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) + (7*Power(t,6)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
            (Power(t,7)*P(7,1))/Power(dur,7))))/
     (Power(dur,7)*Sqrt(Power((-7*Power(1 - t/dur,6)*P(0,0))/dur - \
(42*t*Power(1 - t/dur,5)*P(1,0))/Power(dur,2) + (7*Power(1 - \
t/dur,6)*P(1,0))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,0))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,0))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,0))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,0))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,0))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,0))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,0))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,0))/Power(dur,5) - \
(7*Power(t,6)*P(6,0))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,0))/Power(dur,6) + 
           (7*Power(t,6)*P(7,0))/Power(dur,7),2) + Power((-7*Power(1 - \
t/dur,6)*P(0,1))/dur - (42*t*Power(1 - t/dur,5)*P(1,1))/Power(dur,2) + \
(7*Power(1 - t/dur,6)*P(1,1))/dur - 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(2,1))/Power(dur,3) + \
(42*t*Power(1 - t/dur,5)*P(2,1))/Power(dur,2) - (140*Power(t,3)*Power(1 - \
t/dur,3)*P(3,1))/Power(dur,4) + 
           (105*Power(t,2)*Power(1 - t/dur,4)*P(3,1))/Power(dur,3) - \
(105*Power(t,4)*Power(1 - t/dur,2)*P(4,1))/Power(dur,5) + \
(140*Power(t,3)*Power(1 - t/dur,3)*P(4,1))/Power(dur,4) - 
           (42*Power(t,5)*(1 - t/dur)*P(5,1))/Power(dur,6) + \
(105*Power(t,4)*Power(1 - t/dur,2)*P(5,1))/Power(dur,5) - \
(7*Power(t,6)*P(6,1))/Power(dur,7) + (42*Power(t,5)*(1 - \
t/dur)*P(6,1))/Power(dur,6) + 
           (7*Power(t,6)*P(7,1))/Power(dur,7),2))))\
\>", "Output",
 CellChangeTimes->{
  3.7330794612644777`*^9},ExpressionUUID->"9e71c71e-efd4-4465-91d9-\
57b267f3423e"]
}, Open  ]],

Cell[BoxData[""], "Input",ExpressionUUID->"adc42508-dd99-4fd1-b1d0-be70d2170851"]
},
WindowSize->{1855, 1056},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.2 for Linux x86 (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 4383, 112, 285, "Input",ExpressionUUID->"6e7b734a-c010-42be-b5a8-2506c720815f"],
Cell[CellGroupData[{
Cell[4966, 136, 440, 9, 78, "Input",ExpressionUUID->"a2dca779-c917-4122-a23b-bab17a16250b"],
Cell[5409, 147, 1201, 37, 35, "Output",ExpressionUUID->"285aaf29-2eb7-4411-b2aa-6e583ba1600e"],
Cell[6613, 186, 2468, 40, 244, "Output",ExpressionUUID->"2d6b5ac4-9f0d-4d9d-82dd-4c402397ea3d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9118, 231, 289, 7, 55, "Input",ExpressionUUID->"5fff85ca-afc2-4399-8a6d-e04227a86ba0"],
Cell[9410, 240, 76811, 1277, 8182, "Output",ExpressionUUID->"9e71c71e-efd4-4465-91d9-57b267f3423e"]
}, Open  ]],
Cell[86236, 1520, 81, 0, 31, "Input",ExpressionUUID->"adc42508-dd99-4fd1-b1d0-be70d2170851"]
}
]
*)

