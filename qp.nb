(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     66758,       1871]
NotebookOptionsPosition[     59693,       1749]
NotebookOutlinePosition[     60029,       1764]
CellTagsIndexPosition[     59986,       1761]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
We consider polynomial and bezier trajectories up to the \
\[OpenCurlyQuote]degree\[CloseCurlyQuote]:\
\>", "Text",
 CellChangeTimes->{{3.7333595248672533`*^9, 
  3.7333595625631847`*^9}},ExpressionUUID->"6ffa8bee-575b-4c59-ad18-\
6f206a50072b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"degree", "=", "7"}], ";"}]], "Input",
 CellChangeTimes->{{3.733359569163204*^9, 3.733359571762972*^9}, {
  3.733360631269539*^9, 3.733360631404195*^9}, {3.733360721395323*^9, 
  3.733360721834043*^9}, {3.733429330969213*^9, 3.733429331080152*^9}, {
  3.733430229111714*^9, 3.733430229238892*^9}, {3.7334318879192057`*^9, 
  3.7334319105512753`*^9}, {3.733431968246994*^9, 3.733431972237801*^9}, {
  3.733850835911396*^9, 3.7338508360065413`*^9}, {3.7338508862793837`*^9, 
  3.7338508864383*^9}, {3.733850925719047*^9, 3.733850925855085*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"356cba98-2e24-42df-bdf9-cb0765857e04"],

Cell["\<\
A polynomial trajectory p(t) with coefficients a[] is defined as follows:\
\>", "Text",
 CellChangeTimes->{{3.7333595966936817`*^9, 3.73335961634337*^9}, {
  3.733359860647571*^9, 3.733359873278957*^9}, {3.733359975417886*^9, 
  3.733359982601618*^9}},ExpressionUUID->"3121a830-1fb5-4733-85a4-\
6e7e05289bcd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vecA", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"a", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "degree"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "[", "t_", "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"vecA", "[", 
      RowBox[{"[", 
       RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
     RowBox[{"t", "^", "i"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "0", ",", " ", "degree"}], "}"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.733359633084206*^9, 3.733359639047267*^9}, {
   3.733359875352357*^9, 3.733359875767128*^9}, 3.733359984482614*^9, {
   3.7333612313769913`*^9, 3.733361235111953*^9}, {3.733361365926746*^9, 
   3.733361366541506*^9}, {3.733362145075838*^9, 3.733362155324799*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"d2e5df0a-b363-41a9-b457-24ba5f5c5928"],

Cell["\<\
A Bezier curve f(t) with t in [0,T] and coefficients y[] is given as:\
\>", "Text",
 CellChangeTimes->{{3.7333598492562*^9, 3.733359916692822*^9}, {
  3.7333600634460373`*^9, 
  3.733360077341531*^9}},ExpressionUUID->"209055fd-8df3-409f-94e3-\
05091c2cddcd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vecY", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"y", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "degree"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "[", "t_", "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"vecY", "[", 
      RowBox[{"[", 
       RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
     RowBox[{"Binomial", "[", 
      RowBox[{"degree", ",", "i"}], "]"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"t", "/", "T"}], ")"}], "^", "i"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"t", "/", "T"}]}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"degree", "-", "i"}], ")"}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "0", ",", " ", "degree"}], "}"}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.733359923862801*^9, 3.733359950683662*^9}, {
  3.7333600815106897`*^9, 3.7333600852377443`*^9}, {3.733361474092659*^9, 
  3.7333614750370073`*^9}, {3.7333620607361107`*^9, 3.733362065719302*^9}, {
  3.7333621659970007`*^9, 3.733362168172243*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"3bc29877-a5f7-4cba-841b-3af64ae5142e"],

Cell["\<\
We can create a matrix B that can convert between the two types, see Kenneth \
Joy \[OpenCurlyDoubleQuote]Bernstein Polynomials\[CloseCurlyDoubleQuote]\
\>", "Text",
 CellChangeTimes->{{3.733360682330798*^9, 
  3.733360712211211*^9}},ExpressionUUID->"1c26bc9f-ef89-4ae2-9f25-\
0c362d5fc98e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"column", ">", "row"}], ",", "0", ",", 
         RowBox[{
          RowBox[{"Binomial", "[", 
           RowBox[{
            RowBox[{"degree", "-", "column"}], ",", " ", 
            RowBox[{"row", " ", "-", " ", "column"}]}], "]"}], " ", "*", " ", 
          
          RowBox[{
           RowBox[{"(", 
            RowBox[{"-", "1"}], ")"}], "^", 
           RowBox[{"(", 
            RowBox[{"column", "-", "row"}], ")"}]}], " ", "*", " ", 
          RowBox[{"Binomial", "[", 
           RowBox[{"degree", ",", "column"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"column", ",", "0", ",", "degree"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"row", ",", "0", ",", "degree"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.733360324599402*^9, 3.733360386738999*^9}, {
   3.7333604227539263`*^9, 3.7333605649420853`*^9}, {3.7333605988378353`*^9, 
   3.7333606034694347`*^9}, 3.7333607264914627`*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"7a412217-12bd-4d64-9fcd-f5ae9399e381"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "B", "]"}]], "Input",
 NumberMarks->False,
 CellLabel->"In[7]:=",ExpressionUUID->"5faf7154-b6c0-437a-aaec-87a7c994ee0f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "7"}], "7", "0", "0", "0", "0", "0", "0"},
     {"21", 
      RowBox[{"-", "42"}], "21", "0", "0", "0", "0", "0"},
     {
      RowBox[{"-", "35"}], "105", 
      RowBox[{"-", "105"}], "35", "0", "0", "0", "0"},
     {"35", 
      RowBox[{"-", "140"}], "210", 
      RowBox[{"-", "140"}], "35", "0", "0", "0"},
     {
      RowBox[{"-", "21"}], "105", 
      RowBox[{"-", "210"}], "210", 
      RowBox[{"-", "105"}], "21", "0", "0"},
     {"7", 
      RowBox[{"-", "42"}], "105", 
      RowBox[{"-", "140"}], "105", 
      RowBox[{"-", "42"}], "7", "0"},
     {
      RowBox[{"-", "1"}], "7", 
      RowBox[{"-", "21"}], "35", 
      RowBox[{"-", "35"}], "21", 
      RowBox[{"-", "7"}], "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.733360619859774*^9, 3.733360647432555*^9}, 
   3.733360729453113*^9, 3.73336087329489*^9, 3.733360935977838*^9, 
   3.7333621743829403`*^9, 3.733850852188882*^9, {3.733850893318726*^9, 
   3.7338509314216623`*^9}, 3.733855149488949*^9},
 CellLabel->
  "Out[7]//MatrixForm=",ExpressionUUID->"60cb5da6-f3f9-4848-afbf-\
07311abada79"]
}, Open  ]],

Cell["To convert from polynomial to bezier:", "Text",
 CellChangeTimes->{{3.733360754785185*^9, 
  3.733360767264983*^9}},ExpressionUUID->"3501070b-bf99-427d-a321-\
4a3f9f8dc7ae"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vecA", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"a", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "degree"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vecY", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"vecA", "*", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"T", "^", "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", "degree"}], "}"}]}], "]"}]}], ")"}], ".", 
    RowBox[{"Inverse", "[", "B", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"p", "[", "t", "]"}]}], "Input",
 CellChangeTimes->{{3.73336101950077*^9, 3.733361023723331*^9}, {
  3.7333611313388567`*^9, 3.733361134105441*^9}, {3.733361429045101*^9, 
  3.7333614476756487`*^9}, {3.733361493732045*^9, 3.7333614988186913`*^9}, {
  3.733361968402443*^9, 3.733362034357995*^9}, {3.733362214655285*^9, 
  3.7333622277999077`*^9}, {3.733362385117071*^9, 
  3.733362385909566*^9}},ExpressionUUID->"41dcec2b-b697-4fd3-a1fb-\
960178696f98"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "[", "0", "]"}], "+", 
  RowBox[{"t", " ", 
   RowBox[{"a", "[", "1", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["t", "2"], " ", 
   RowBox[{"a", "[", "2", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["t", "3"], " ", 
   RowBox[{"a", "[", "3", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["t", "4"], " ", 
   RowBox[{"a", "[", "4", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["t", "5"], " ", 
   RowBox[{"a", "[", "5", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["t", "6"], " ", 
   RowBox[{"a", "[", "6", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["t", "7"], " ", 
   RowBox[{"a", "[", "7", "]"}]}]}]], "Output",
 CellChangeTimes->{3.73336222842482*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"e02e5fe8-5e14-4c8c-920c-8f600878665f"]
}, Open  ]],

Cell["To convert from bezier to polynomial:", "Text",
 CellChangeTimes->{{3.73336225195892*^9, 
  3.733362271991791*^9}},ExpressionUUID->"f432ffec-d8f8-4326-965a-\
8aa89ed1b4fb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vecY", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"y", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "degree"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vecA", "=", 
   RowBox[{"vecY", ".", "B"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"f", "[", "t", "]"}]}], "Input",
 CellChangeTimes->{{3.733362283497397*^9, 3.733362330457738*^9}, {
  3.73336239472528*^9, 3.733362395597723*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"c312f41c-a559-427c-b23f-4fde61e4c303"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox["t", "T"]}], ")"}], "7"], " ", 
   RowBox[{"y", "[", "0", "]"}]}], "+", 
  FractionBox[
   RowBox[{"7", " ", "t", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox["t", "T"]}], ")"}], "6"], " ", 
    RowBox[{"y", "[", "1", "]"}]}], "T"], "+", 
  FractionBox[
   RowBox[{"21", " ", 
    SuperscriptBox["t", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox["t", "T"]}], ")"}], "5"], " ", 
    RowBox[{"y", "[", "2", "]"}]}], 
   SuperscriptBox["T", "2"]], "+", 
  FractionBox[
   RowBox[{"35", " ", 
    SuperscriptBox["t", "3"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox["t", "T"]}], ")"}], "4"], " ", 
    RowBox[{"y", "[", "3", "]"}]}], 
   SuperscriptBox["T", "3"]], "+", 
  FractionBox[
   RowBox[{"35", " ", 
    SuperscriptBox["t", "4"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox["t", "T"]}], ")"}], "3"], " ", 
    RowBox[{"y", "[", "4", "]"}]}], 
   SuperscriptBox["T", "4"]], "+", 
  FractionBox[
   RowBox[{"21", " ", 
    SuperscriptBox["t", "5"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox["t", "T"]}], ")"}], "2"], " ", 
    RowBox[{"y", "[", "5", "]"}]}], 
   SuperscriptBox["T", "5"]], "+", 
  FractionBox[
   RowBox[{"7", " ", 
    SuperscriptBox["t", "6"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      FractionBox["t", "T"]}], ")"}], " ", 
    RowBox[{"y", "[", "6", "]"}]}], 
   SuperscriptBox["T", "6"]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["t", "7"], " ", 
    RowBox[{"y", "[", "7", "]"}]}], 
   SuperscriptBox["T", "7"]]}]], "Output",
 CellChangeTimes->{{3.733362305542944*^9, 3.733362330985989*^9}, 
   3.7333623969645023`*^9},
 CellLabel->"Out[54]=",ExpressionUUID->"98eb70a3-1faf-4cca-8ab9-52a411abaf68"]
}, Open  ]],

Cell["Objective: Squared position integral", "Text",
 CellChangeTimes->{{3.733429023575433*^9, 
  3.7334290396544847`*^9}},ExpressionUUID->"4faec8e5-8081-4f26-84ae-\
fec9cd71eb1a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "[", "t", "]"}], "^", "2"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.733429047998588*^9, 3.733429084756104*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"65a1e25b-4d9e-42a4-942e-73f4cae95ac0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"T", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "0", "]"}], "2"]}], "+", 
  RowBox[{
   SuperscriptBox["T", "2"], " ", 
   RowBox[{"a", "[", "0", "]"}], " ", 
   RowBox[{"a", "[", "1", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "3"], " ", 
   SuperscriptBox["T", "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["2", "3"], " ", 
   SuperscriptBox["T", "3"], " ", 
   RowBox[{"a", "[", "0", "]"}], " ", 
   RowBox[{"a", "[", "2", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   SuperscriptBox["T", "4"], " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"a", "[", "2", "]"}]}], "+", 
  RowBox[{
   FractionBox["1", "5"], " ", 
   SuperscriptBox["T", "5"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.733429087120779*^9, 3.733429105705299*^9}, 
   3.7334293372035303`*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"20263487-20f7-4eeb-ac74-76f76d485f7e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Qp", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"row", "+", "column", "+", "1"}], ")"}]}], "*", 
       RowBox[{"T", "^", 
        RowBox[{"(", 
         RowBox[{"row", "+", "column", "+", "1"}], ")"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"column", ",", "0", ",", "degree"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"row", ",", "0", ",", "degree"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.733429139738031*^9, 3.73342923766849*^9}, {
  3.733429357056655*^9, 3.7334293602392197`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"d9b8cd25-7887-4763-8583-a9bcf6ca8349"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"T", ",", 
     FractionBox[
      SuperscriptBox["T", "2"], "2"], ",", 
     FractionBox[
      SuperscriptBox["T", "3"], "3"], ",", 
     FractionBox[
      SuperscriptBox["T", "4"], "4"], ",", 
     FractionBox[
      SuperscriptBox["T", "5"], "5"], ",", 
     FractionBox[
      SuperscriptBox["T", "6"], "6"], ",", 
     FractionBox[
      SuperscriptBox["T", "7"], "7"], ",", 
     FractionBox[
      SuperscriptBox["T", "8"], "8"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SuperscriptBox["T", "2"], "2"], ",", 
     FractionBox[
      SuperscriptBox["T", "3"], "3"], ",", 
     FractionBox[
      SuperscriptBox["T", "4"], "4"], ",", 
     FractionBox[
      SuperscriptBox["T", "5"], "5"], ",", 
     FractionBox[
      SuperscriptBox["T", "6"], "6"], ",", 
     FractionBox[
      SuperscriptBox["T", "7"], "7"], ",", 
     FractionBox[
      SuperscriptBox["T", "8"], "8"], ",", 
     FractionBox[
      SuperscriptBox["T", "9"], "9"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SuperscriptBox["T", "3"], "3"], ",", 
     FractionBox[
      SuperscriptBox["T", "4"], "4"], ",", 
     FractionBox[
      SuperscriptBox["T", "5"], "5"], ",", 
     FractionBox[
      SuperscriptBox["T", "6"], "6"], ",", 
     FractionBox[
      SuperscriptBox["T", "7"], "7"], ",", 
     FractionBox[
      SuperscriptBox["T", "8"], "8"], ",", 
     FractionBox[
      SuperscriptBox["T", "9"], "9"], ",", 
     FractionBox[
      SuperscriptBox["T", "10"], "10"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SuperscriptBox["T", "4"], "4"], ",", 
     FractionBox[
      SuperscriptBox["T", "5"], "5"], ",", 
     FractionBox[
      SuperscriptBox["T", "6"], "6"], ",", 
     FractionBox[
      SuperscriptBox["T", "7"], "7"], ",", 
     FractionBox[
      SuperscriptBox["T", "8"], "8"], ",", 
     FractionBox[
      SuperscriptBox["T", "9"], "9"], ",", 
     FractionBox[
      SuperscriptBox["T", "10"], "10"], ",", 
     FractionBox[
      SuperscriptBox["T", "11"], "11"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SuperscriptBox["T", "5"], "5"], ",", 
     FractionBox[
      SuperscriptBox["T", "6"], "6"], ",", 
     FractionBox[
      SuperscriptBox["T", "7"], "7"], ",", 
     FractionBox[
      SuperscriptBox["T", "8"], "8"], ",", 
     FractionBox[
      SuperscriptBox["T", "9"], "9"], ",", 
     FractionBox[
      SuperscriptBox["T", "10"], "10"], ",", 
     FractionBox[
      SuperscriptBox["T", "11"], "11"], ",", 
     FractionBox[
      SuperscriptBox["T", "12"], "12"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SuperscriptBox["T", "6"], "6"], ",", 
     FractionBox[
      SuperscriptBox["T", "7"], "7"], ",", 
     FractionBox[
      SuperscriptBox["T", "8"], "8"], ",", 
     FractionBox[
      SuperscriptBox["T", "9"], "9"], ",", 
     FractionBox[
      SuperscriptBox["T", "10"], "10"], ",", 
     FractionBox[
      SuperscriptBox["T", "11"], "11"], ",", 
     FractionBox[
      SuperscriptBox["T", "12"], "12"], ",", 
     FractionBox[
      SuperscriptBox["T", "13"], "13"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SuperscriptBox["T", "7"], "7"], ",", 
     FractionBox[
      SuperscriptBox["T", "8"], "8"], ",", 
     FractionBox[
      SuperscriptBox["T", "9"], "9"], ",", 
     FractionBox[
      SuperscriptBox["T", "10"], "10"], ",", 
     FractionBox[
      SuperscriptBox["T", "11"], "11"], ",", 
     FractionBox[
      SuperscriptBox["T", "12"], "12"], ",", 
     FractionBox[
      SuperscriptBox["T", "13"], "13"], ",", 
     FractionBox[
      SuperscriptBox["T", "14"], "14"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      SuperscriptBox["T", "8"], "8"], ",", 
     FractionBox[
      SuperscriptBox["T", "9"], "9"], ",", 
     FractionBox[
      SuperscriptBox["T", "10"], "10"], ",", 
     FractionBox[
      SuperscriptBox["T", "11"], "11"], ",", 
     FractionBox[
      SuperscriptBox["T", "12"], "12"], ",", 
     FractionBox[
      SuperscriptBox["T", "13"], "13"], ",", 
     FractionBox[
      SuperscriptBox["T", "14"], "14"], ",", 
     FractionBox[
      SuperscriptBox["T", "15"], "15"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.733429219734939*^9, 3.7334292392941513`*^9}, {
  3.7334293416677856`*^9, 3.7334293612615623`*^9}, {3.733431901084721*^9, 
  3.733431926005884*^9}},
 CellLabel->"Out[58]=",ExpressionUUID->"a0b997d5-bfc0-4a71-9e7d-99093c78990b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "Qp", "]"}]], "Input",
 NumberMarks->False,
 CellLabel->"In[59]:=",ExpressionUUID->"90e073cc-2312-4089-9c23-1cc6293e396b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"T", 
      FractionBox[
       SuperscriptBox["T", "2"], "2"], 
      FractionBox[
       SuperscriptBox["T", "3"], "3"], 
      FractionBox[
       SuperscriptBox["T", "4"], "4"], 
      FractionBox[
       SuperscriptBox["T", "5"], "5"], 
      FractionBox[
       SuperscriptBox["T", "6"], "6"], 
      FractionBox[
       SuperscriptBox["T", "7"], "7"], 
      FractionBox[
       SuperscriptBox["T", "8"], "8"]},
     {
      FractionBox[
       SuperscriptBox["T", "2"], "2"], 
      FractionBox[
       SuperscriptBox["T", "3"], "3"], 
      FractionBox[
       SuperscriptBox["T", "4"], "4"], 
      FractionBox[
       SuperscriptBox["T", "5"], "5"], 
      FractionBox[
       SuperscriptBox["T", "6"], "6"], 
      FractionBox[
       SuperscriptBox["T", "7"], "7"], 
      FractionBox[
       SuperscriptBox["T", "8"], "8"], 
      FractionBox[
       SuperscriptBox["T", "9"], "9"]},
     {
      FractionBox[
       SuperscriptBox["T", "3"], "3"], 
      FractionBox[
       SuperscriptBox["T", "4"], "4"], 
      FractionBox[
       SuperscriptBox["T", "5"], "5"], 
      FractionBox[
       SuperscriptBox["T", "6"], "6"], 
      FractionBox[
       SuperscriptBox["T", "7"], "7"], 
      FractionBox[
       SuperscriptBox["T", "8"], "8"], 
      FractionBox[
       SuperscriptBox["T", "9"], "9"], 
      FractionBox[
       SuperscriptBox["T", "10"], "10"]},
     {
      FractionBox[
       SuperscriptBox["T", "4"], "4"], 
      FractionBox[
       SuperscriptBox["T", "5"], "5"], 
      FractionBox[
       SuperscriptBox["T", "6"], "6"], 
      FractionBox[
       SuperscriptBox["T", "7"], "7"], 
      FractionBox[
       SuperscriptBox["T", "8"], "8"], 
      FractionBox[
       SuperscriptBox["T", "9"], "9"], 
      FractionBox[
       SuperscriptBox["T", "10"], "10"], 
      FractionBox[
       SuperscriptBox["T", "11"], "11"]},
     {
      FractionBox[
       SuperscriptBox["T", "5"], "5"], 
      FractionBox[
       SuperscriptBox["T", "6"], "6"], 
      FractionBox[
       SuperscriptBox["T", "7"], "7"], 
      FractionBox[
       SuperscriptBox["T", "8"], "8"], 
      FractionBox[
       SuperscriptBox["T", "9"], "9"], 
      FractionBox[
       SuperscriptBox["T", "10"], "10"], 
      FractionBox[
       SuperscriptBox["T", "11"], "11"], 
      FractionBox[
       SuperscriptBox["T", "12"], "12"]},
     {
      FractionBox[
       SuperscriptBox["T", "6"], "6"], 
      FractionBox[
       SuperscriptBox["T", "7"], "7"], 
      FractionBox[
       SuperscriptBox["T", "8"], "8"], 
      FractionBox[
       SuperscriptBox["T", "9"], "9"], 
      FractionBox[
       SuperscriptBox["T", "10"], "10"], 
      FractionBox[
       SuperscriptBox["T", "11"], "11"], 
      FractionBox[
       SuperscriptBox["T", "12"], "12"], 
      FractionBox[
       SuperscriptBox["T", "13"], "13"]},
     {
      FractionBox[
       SuperscriptBox["T", "7"], "7"], 
      FractionBox[
       SuperscriptBox["T", "8"], "8"], 
      FractionBox[
       SuperscriptBox["T", "9"], "9"], 
      FractionBox[
       SuperscriptBox["T", "10"], "10"], 
      FractionBox[
       SuperscriptBox["T", "11"], "11"], 
      FractionBox[
       SuperscriptBox["T", "12"], "12"], 
      FractionBox[
       SuperscriptBox["T", "13"], "13"], 
      FractionBox[
       SuperscriptBox["T", "14"], "14"]},
     {
      FractionBox[
       SuperscriptBox["T", "8"], "8"], 
      FractionBox[
       SuperscriptBox["T", "9"], "9"], 
      FractionBox[
       SuperscriptBox["T", "10"], "10"], 
      FractionBox[
       SuperscriptBox["T", "11"], "11"], 
      FractionBox[
       SuperscriptBox["T", "12"], "12"], 
      FractionBox[
       SuperscriptBox["T", "13"], "13"], 
      FractionBox[
       SuperscriptBox["T", "14"], "14"], 
      FractionBox[
       SuperscriptBox["T", "15"], "15"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7334292530183983`*^9, 3.7334293655693073`*^9, 
  3.7334319281998987`*^9},
 CellLabel->
  "Out[59]//MatrixForm=",ExpressionUUID->"8b19519c-bcab-49a9-a101-\
98283ba15a8f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"vecA", ".", "Qp", ".", "vecA"}], ")"}], "\[Equal]", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", "t", "]"}], "^", "2"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.733429279114972*^9, 3.733429318688684*^9}, {
  3.73342937944753*^9, 3.7334294525315323`*^9}, {3.733429491523388*^9, 
  3.733429516585511*^9}, {3.733431864696116*^9, 3.733431876470441*^9}, {
  3.733431938327338*^9, 3.733431941934153*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"1bff4f71-8dd1-4982-be34-f744259aae69"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.733429287059613*^9, 3.733429319471223*^9}, {
   3.73342937194517*^9, 3.7334294535438004`*^9}, {3.7334295039318027`*^9, 
   3.7334295177488194`*^9}, 3.733431877077853*^9, {3.733431932470538*^9, 
   3.733431942574432*^9}},
 CellLabel->"Out[61]=",ExpressionUUID->"d9ba10ea-f920-4b9e-81f0-34dfa736de49"]
}, Open  ]],

Cell["Objective: Squared velocity integral", "Text",
 CellChangeTimes->{{3.733429558989182*^9, 
  3.733429561815737*^9}},ExpressionUUID->"9b332c64-3353-4d4a-8709-\
c90db453f331"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"p", "[", "t", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "^", "2"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.733429570696535*^9, 3.733429586127288*^9}, {
  3.733429692932103*^9, 3.733429694820032*^9}, {3.733430765839663*^9, 
  3.733430765998464*^9}, {3.733430981900734*^9, 3.733430982347672*^9}, {
  3.7334312052234783`*^9, 3.733431206854332*^9}, {3.7334319873348722`*^9, 
  3.7334320030378036`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"07c186da-0fd2-4fb1-a9e2-58ddcce1a86a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"4", " ", "T", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"12", " ", 
   SuperscriptBox["T", "2"], " ", 
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"a", "[", "3", "]"}]}], "+", 
  RowBox[{"12", " ", 
   SuperscriptBox["T", "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{
  3.733429697208946*^9, 3.733430242265482*^9, 3.733430767229076*^9, 
   3.733430983760626*^9, 3.733431208858872*^9, {3.733431980117547*^9, 
   3.733432004409178*^9}, 3.7334325802634583`*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"e23efc2a-30cf-4de6-9290-e0a9ba62208f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Qa", " ", "=", " ", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"qa", "[", 
       RowBox[{"row", ",", "column"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"column", ",", "0", ",", "degree"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"row", ",", "0", ",", "degree"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.73343209043736*^9, 3.733432092192067*^9}, {
  3.733432127500778*^9, 3.733432170300688*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"a62c6189-fb2e-48a0-b163-45ca657f9030"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"qa", "[", 
      RowBox[{"0", ",", "0"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"0", ",", "1"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"0", ",", "2"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"0", ",", "3"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"qa", "[", 
      RowBox[{"1", ",", "0"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"1", ",", "1"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"qa", "[", 
      RowBox[{"2", ",", "0"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"2", ",", "1"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"qa", "[", 
      RowBox[{"3", ",", "0"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"3", ",", "1"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"3", ",", "2"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.733432171844809*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"56878f9f-023e-4e9a-abc9-0c2ab2660d1d"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.733429546209608*^9, 
  3.7334295471681967`*^9}},ExpressionUUID->"1ffd2989-958e-423d-a914-\
059b25ab5d43"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindInstance", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"vecA", ".", "Qa", ".", "vecA"}], ")"}], "==", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"p", "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "2"}], "}"}]}], "]"}], "^", "2"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"Flatten", "[", "Qa", "]"}], ",", "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.733432177941185*^9, 3.733432223556271*^9}, {
  3.7334322543416853`*^9, 3.7334322548025312`*^9}, {3.73343234173315*^9, 
  3.733432343579668*^9}, {3.7334323820924797`*^9, 3.7334323830753508`*^9}, {
  3.733432482555997*^9, 3.733432482650498*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"8fc69d1a-fc20-4786-afc7-fe166cb8a4c4"],

Cell[BoxData[
 TemplateBox[{
  "FindInstance","exvar",
   "\"The system contains a nonconstant expression \
\\!\\(\\*RowBox[{\\\"a\\\", \\\"[\\\", \\\"0\\\", \\\"]\\\"}]\\) independent \
of variables \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"qa\\\", \
\\\"[\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"qa\\\", \\\"[\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"1\\\"}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"qa\\\", \\\"[\\\", RowBox[{\\\"0\\\", \
\\\",\\\", \\\"2\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"qa\\\", \
\\\"[\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"3\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"qa\\\", \\\"[\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"qa\\\", \\\"[\\\", RowBox[{\\\"1\\\", \
\\\",\\\", \\\"1\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"qa\\\", \
\\\"[\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"2\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"qa\\\", \\\"[\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"3\\\"}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"qa\\\", \\\"[\\\", RowBox[{\\\"2\\\", \
\\\",\\\", \\\"0\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"qa\\\", \
\\\"[\\\", RowBox[{\\\"2\\\", \\\",\\\", \\\"1\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"qa\\\", \\\"[\\\", RowBox[{\\\"2\\\", \\\",\\\", \\\"2\\\"}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"qa\\\", \\\"[\\\", RowBox[{\\\"2\\\", \
\\\",\\\", \\\"3\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"qa\\\", \
\\\"[\\\", RowBox[{\\\"3\\\", \\\",\\\", \\\"0\\\"}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"qa\\\", \\\"[\\\", RowBox[{\\\"3\\\", \\\",\\\", \\\"1\\\"}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"qa\\\", \\\"[\\\", RowBox[{\\\"3\\\", \
\\\",\\\", \\\"2\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"qa\\\", \
\\\"[\\\", RowBox[{\\\"3\\\", \\\",\\\", \\\"3\\\"}], \\\"]\\\"}]}], \
\\\"}\\\"}]\\).\"",2,76,16,28200589440425669389,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{{3.73343220007341*^9, 3.733432224248583*^9}, 
   3.73343225712493*^9, 3.733432344754756*^9, 3.733432384384761*^9, 
   3.733432483397046*^9},
 CellLabel->
  "During evaluation of \
In[76]:=",ExpressionUUID->"9e553d19-520f-4cc6-b095-3a84e06138d3"],

Cell[BoxData[
 RowBox[{"FindInstance", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], " ", 
         RowBox[{"qa", "[", 
          RowBox[{"0", ",", "0"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "[", "1", "]"}], " ", 
         RowBox[{"qa", "[", 
          RowBox[{"1", ",", "0"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "[", "2", "]"}], " ", 
         RowBox[{"qa", "[", 
          RowBox[{"2", ",", "0"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "[", "3", "]"}], " ", 
         RowBox[{"qa", "[", 
          RowBox[{"3", ",", "0"}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], " ", 
         RowBox[{"qa", "[", 
          RowBox[{"0", ",", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "[", "1", "]"}], " ", 
         RowBox[{"qa", "[", 
          RowBox[{"1", ",", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "[", "2", "]"}], " ", 
         RowBox[{"qa", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "[", "3", "]"}], " ", 
         RowBox[{"qa", "[", 
          RowBox[{"3", ",", "1"}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], " ", 
         RowBox[{"qa", "[", 
          RowBox[{"0", ",", "2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "[", "1", "]"}], " ", 
         RowBox[{"qa", "[", 
          RowBox[{"1", ",", "2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "[", "2", "]"}], " ", 
         RowBox[{"qa", "[", 
          RowBox[{"2", ",", "2"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "[", "3", "]"}], " ", 
         RowBox[{"qa", "[", 
          RowBox[{"3", ",", "2"}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], " ", 
         RowBox[{"qa", "[", 
          RowBox[{"0", ",", "3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "[", "1", "]"}], " ", 
         RowBox[{"qa", "[", 
          RowBox[{"1", ",", "3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "[", "2", "]"}], " ", 
         RowBox[{"qa", "[", 
          RowBox[{"2", ",", "3"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"a", "[", "3", "]"}], " ", 
         RowBox[{"qa", "[", 
          RowBox[{"3", ",", "3"}], "]"}]}]}], ")"}]}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
     RowBox[{"12", " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"a", "[", "3", "]"}]}], "+", 
     RowBox[{"12", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"]}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"qa", "[", 
      RowBox[{"0", ",", "0"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"0", ",", "1"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"0", ",", "2"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"0", ",", "3"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"1", ",", "0"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"1", ",", "1"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"1", ",", "3"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"2", ",", "0"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"2", ",", "1"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"2", ",", "3"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"3", ",", "0"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"3", ",", "1"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"3", ",", "2"}], "]"}], ",", 
     RowBox[{"qa", "[", 
      RowBox[{"3", ",", "3"}], "]"}]}], "}"}], ",", 
   TemplateBox[{},
    "Reals"]}], "]"}]], "Output",
 CellChangeTimes->{{3.733432200075321*^9, 3.733432224305121*^9}, 
   3.7334322571357613`*^9, 3.733432344766266*^9, 3.7334323844604273`*^9, 
   3.733432483408333*^9},
 CellLabel->"Out[76]=",ExpressionUUID->"4abbb112-4faa-436d-b68d-ab300b66ff27"]
}, Open  ]],

Cell[BoxData["\[AliasDelimiter]"], "Input",
 CellChangeTimes->{{3.7338551544031897`*^9, 
  3.7338551605784883`*^9}},ExpressionUUID->"6756f914-a5bd-4eb4-9597-\
05655a694fd3"],

Cell["Snap", "Text",
 CellChangeTimes->{{3.7338551648901663`*^9, 
  3.733855165602248*^9}},ExpressionUUID->"b3dfe17c-fa40-462d-a97b-\
93fc7e4750ac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"p", "[", "t", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "4"}], "}"}]}], "]"}], "^", "2"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7338551699545183`*^9, 3.7338551730903788`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"f00ffd47-a6c8-49bb-b331-7ac5a2f4e961"],

Cell[BoxData[
 RowBox[{
  RowBox[{"576", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{"2880", " ", 
   RowBox[{"a", "[", "4", "]"}], " ", 
   RowBox[{"a", "[", "5", "]"}]}], "+", 
  RowBox[{"4800", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "5", "]"}], "2"]}], "+", 
  RowBox[{"5760", " ", 
   RowBox[{"a", "[", "4", "]"}], " ", 
   RowBox[{"a", "[", "6", "]"}]}], "+", 
  RowBox[{"21600", " ", 
   RowBox[{"a", "[", "5", "]"}], " ", 
   RowBox[{"a", "[", "6", "]"}]}], "+", 
  RowBox[{"25920", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "6", "]"}], "2"]}], "+", 
  RowBox[{"10080", " ", 
   RowBox[{"a", "[", "4", "]"}], " ", 
   RowBox[{"a", "[", "7", "]"}]}], "+", 
  RowBox[{"40320", " ", 
   RowBox[{"a", "[", "5", "]"}], " ", 
   RowBox[{"a", "[", "7", "]"}]}], "+", 
  RowBox[{"100800", " ", 
   RowBox[{"a", "[", "6", "]"}], " ", 
   RowBox[{"a", "[", "7", "]"}]}], "+", 
  RowBox[{"100800", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "7", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.733855173593787*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"8fa86029-3c1d-4f64-820b-ce863e5d0f5e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Qsnap", "=", 
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "576", "1440", "2880", "5040"},
     {"0", "0", "0", "0", "1440", "4800", "10800", "20160"},
     {"0", "0", "0", "0", "2880", "10800", "25920", "50400"},
     {"0", "0", "0", "0", "5040", "20160", "50400", "100800"}
    }], "\[NoBreak]", ")"}]}]], "Input",
 CellChangeTimes->{{3.733856284262298*^9, 3.7338563766670113`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"68ac6a0b-8177-45e3-8a8f-ac353bdf72c9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "576", ",", "1440", ",", "2880", 
     ",", "5040"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "1440", ",", "4800", ",", "10800",
      ",", "20160"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "2880", ",", "10800", ",", 
     "25920", ",", "50400"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "5040", ",", "20160", ",", 
     "50400", ",", "100800"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7338563792279778`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"28741692-28ee-4061-b4bd-05947770da03"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"vecA", ".", "Qsnap", ".", "vecA"}], ")"}], "\[Equal]", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"p", "[", "t", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "4"}], "}"}]}], "]"}], "^", "2"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7338553046573544`*^9, 3.733855312431727*^9}, 
   3.733855370458048*^9, {3.733856383380574*^9, 3.733856385259749*^9}, {
   3.7338564316305*^9, 3.733856447850861*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"3eb52bad-613e-453a-9ad8-e69929065159"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.7338553128629103`*^9, 3.733855372387763*^9, 
  3.733856386160801*^9, 3.733856449255724*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"8c95233c-1a7b-4e3d-b9d7-de3634e5255a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PositiveDefiniteMatrixQ", "[", "Qsnap", "]"}]], "Input",
 CellChangeTimes->{{3.733856455281788*^9, 3.733856477730626*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"17afaeab-859f-493e-9900-6c1585f4639f"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.733856478794166*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"a8f2aa47-46cf-4a0e-abb9-5dbf570a12d8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PositiveSemidefiniteMatrixQ", "[", "Qsnap", "]"}]], "Input",
 CellChangeTimes->{{3.73385648016336*^9, 3.733856485907147*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"7c038bec-0cdd-48f7-93e3-1d59d66cc27d"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.733856486893228*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"c9b4f1f4-b342-4fcc-bf8e-a64b4e10958b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{
   RowBox[{"B", "\[Transpose]"}], ".", "Qsnap", ".", "B"}], "]"}]], "Input",
 CellChangeTimes->{{3.7338565030769033`*^9, 3.733856514605036*^9}, {
  3.7338566878713217`*^9, 3.733856688285995*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"7c60f92f-0c80-413d-a099-abbb936b8817"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"100800", 
      RowBox[{"-", "352800"}], "423360", 
      RowBox[{"-", "176400"}], "0", "0", "0", "5040"},
     {
      RowBox[{"-", "352800"}], "1270080", 
      RowBox[{"-", "1587600"}], "705600", "0", "0", 
      RowBox[{"-", "35280"}], "0"},
     {"423360", 
      RowBox[{"-", "1587600"}], "2116800", 
      RowBox[{"-", "1058400"}], "0", "105840", "0", "0"},
     {
      RowBox[{"-", "176400"}], "705600", 
      RowBox[{"-", "1058400"}], "705600", 
      RowBox[{"-", "176400"}], "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "176400"}], "705600", 
      RowBox[{"-", "1058400"}], "705600", 
      RowBox[{"-", "176400"}]},
     {"0", "0", "105840", "0", 
      RowBox[{"-", "1058400"}], "2116800", 
      RowBox[{"-", "1587600"}], "423360"},
     {"0", 
      RowBox[{"-", "35280"}], "0", "0", "705600", 
      RowBox[{"-", "1587600"}], "1270080", 
      RowBox[{"-", "352800"}]},
     {"5040", "0", "0", "0", 
      RowBox[{"-", "176400"}], "423360", 
      RowBox[{"-", "352800"}], "100800"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.733856506206478*^9, 3.733856515131606*^9}, 
   3.733856690041718*^9},
 CellLabel->
  "Out[20]//MatrixForm=",ExpressionUUID->"1586a633-b3c9-49d3-b46d-\
303027ea6840"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.733856471602331*^9, 
  3.7338564740182667`*^9}},ExpressionUUID->"394e6560-c2ba-4f06-84b8-\
d51b5eb2c9ca"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PositiveSemidefiniteMatrixQ", "[", 
  RowBox[{
   RowBox[{"B", "\[Transpose]"}], ".", "Qsnap", ".", "B"}], "]"}]], "Input",
 CellChangeTimes->{{3.7338567216073017`*^9, 3.733856722295301*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"ec27800f-f804-4572-8bdc-e0ad573654c7"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.733856722751807*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"547a8c5d-f328-4d9a-9f9f-96ce8ac570cd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"f1", "[", "t_", "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"vecY", "[", 
      RowBox[{"[", 
       RowBox[{"i", "+", "1"}], "]"}], "]"}], "*", 
     RowBox[{"Binomial", "[", 
      RowBox[{"degree", ",", "i"}], "]"}], "*", 
     RowBox[{"t", "^", "i"}], "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "t"}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{"degree", "-", "i"}], ")"}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"i", ",", " ", "0", ",", " ", "degree"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.733858085346651*^9, 3.733858086232192*^9}, {
  3.7338581189398613`*^9, 3.733858126992321*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"a1e29bc7-4fc7-403d-82c8-03999a30d020"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", "t", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "1"}], "}"}]}], "]"}], ",", 
   RowBox[{"t", "\[Rule]", "T"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7338581310007057`*^9, 3.733858138367839*^9}, {
   3.733858194808907*^9, 3.7338582831107473`*^9}, {3.733858319639448*^9, 
   3.733858345686309*^9}, {3.733858650404023*^9, 3.7338586504668913`*^9}, {
   3.733862832633295*^9, 3.733862832888219*^9}, {3.73386290444121*^9, 
   3.733862922688043*^9}, {3.733864337860361*^9, 3.733864342354557*^9}, {
   3.734128649794697*^9, 3.734128710010243*^9}, {3.734128836908057*^9, 
   3.734128863018841*^9}, {3.734129040716549*^9, 3.734129040843336*^9}, {
   3.7341293763849573`*^9, 3.734129474012169*^9}, {3.734138588282646*^9, 
   3.734138591241583*^9}, {3.734139045963791*^9, 3.734139122266666*^9}, {
   3.734470822539576*^9, 3.734470868658257*^9}, {3.734470900219088*^9, 
   3.734470914242031*^9}, 3.734470962202833*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"d5597c04-b12b-465d-9901-8fb6f7b27725"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"7", " ", 
     RowBox[{"y", "[", "6", "]"}]}], "T"]}], "+", 
  FractionBox[
   RowBox[{"7", " ", 
    RowBox[{"y", "[", "7", "]"}]}], "T"]}]], "Output",
 CellChangeTimes->{{3.733858132749344*^9, 3.733858138703318*^9}, {
   3.7338581957674503`*^9, 3.733858217492228*^9}, {3.733858247885273*^9, 
   3.733858283564761*^9}, {3.73385832799605*^9, 3.7338583466773577`*^9}, 
   3.733858651425283*^9, 3.733862833535203*^9, {3.733862905710188*^9, 
   3.733862923366726*^9}, 3.733864358521603*^9, {3.734128652155159*^9, 
   3.734128710982127*^9}, {3.7341288380045223`*^9, 3.7341288687400723`*^9}, 
   3.734129041278983*^9, {3.734129377273629*^9, 3.7341294744052763`*^9}, 
   3.73413859316363*^9, {3.734138627457449*^9, 3.734138631654351*^9}, {
   3.734139046964855*^9, 3.734139122725605*^9}, {3.734470837709256*^9, 
   3.734470869165196*^9}, {3.734470901493313*^9, 3.734470914921475*^9}, 
   3.734470962589157*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"b0b81697-5ea5-476e-af71-c1370270e373"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BI", "=", 
  RowBox[{"Inverse", "[", "B", "]"}]}]], "Input",
 CellChangeTimes->{{3.733863782496784*^9, 3.7338638227007008`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"0872e26a-92b1-4c5b-8334-d73d9c219b58"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", "7"], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["2", "7"], ",", 
     FractionBox["1", "21"], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["3", "7"], ",", 
     FractionBox["1", "7"], ",", 
     FractionBox["1", "35"], ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["4", "7"], ",", 
     FractionBox["2", "7"], ",", 
     FractionBox["4", "35"], ",", 
     FractionBox["1", "35"], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["5", "7"], ",", 
     FractionBox["10", "21"], ",", 
     FractionBox["2", "7"], ",", 
     FractionBox["1", "7"], ",", 
     FractionBox["1", "21"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["6", "7"], ",", 
     FractionBox["5", "7"], ",", 
     FractionBox["4", "7"], ",", 
     FractionBox["3", "7"], ",", 
     FractionBox["2", "7"], ",", 
     FractionBox["1", "7"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
     "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7338637887186937`*^9, 3.733863823602776*^9}},
 CellLabel->"Out[42]=",ExpressionUUID->"5c5db12a-0be3-4ee8-85f5-bb330e1b25a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PositiveSemidefiniteMatrixQ", "[", 
  RowBox[{
   RowBox[{"BI", "\[Transpose]"}], ".", "Qsnap", ".", "BI"}], "]"}]], "Input",\

 CellChangeTimes->{{3.733863830852749*^9, 3.733863833332732*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"b47fbed1-2a83-4da7-87ed-71ef5d9cc03c"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.7338638339475927`*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"8e87c685-f291-4f54-a2da-4b27682fc4cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"p", "[", "t", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "1"}], "}"}]}], "]"}], "^", "2"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.73386472422583*^9, 3.733864724305793*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"289ee813-a62e-4895-8dba-c2e69a412339"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"a", "[", "1", "]"}], "2"], "+", 
  RowBox[{"2", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"a", "[", "2", "]"}]}], "+", 
  FractionBox[
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"]}], "3"], "+", 
  RowBox[{"2", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"a", "[", "3", "]"}]}], "+", 
  RowBox[{"3", " ", 
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"a", "[", "3", "]"}]}], "+", 
  FractionBox[
   RowBox[{"9", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"]}], "5"], "+", 
  RowBox[{"2", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"a", "[", "4", "]"}]}], "+", 
  RowBox[{
   FractionBox["16", "5"], " ", 
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"a", "[", "4", "]"}]}], "+", 
  RowBox[{"4", " ", 
   RowBox[{"a", "[", "3", "]"}], " ", 
   RowBox[{"a", "[", "4", "]"}]}], "+", 
  FractionBox[
   RowBox[{"16", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "4", "]"}], "2"]}], "7"], "+", 
  RowBox[{"2", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"a", "[", "5", "]"}]}], "+", 
  RowBox[{
   FractionBox["10", "3"], " ", 
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"a", "[", "5", "]"}]}], "+", 
  RowBox[{
   FractionBox["30", "7"], " ", 
   RowBox[{"a", "[", "3", "]"}], " ", 
   RowBox[{"a", "[", "5", "]"}]}], "+", 
  RowBox[{"5", " ", 
   RowBox[{"a", "[", "4", "]"}], " ", 
   RowBox[{"a", "[", "5", "]"}]}], "+", 
  FractionBox[
   RowBox[{"25", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "5", "]"}], "2"]}], "9"], "+", 
  RowBox[{"2", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"a", "[", "6", "]"}]}], "+", 
  RowBox[{
   FractionBox["24", "7"], " ", 
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"a", "[", "6", "]"}]}], "+", 
  RowBox[{
   FractionBox["9", "2"], " ", 
   RowBox[{"a", "[", "3", "]"}], " ", 
   RowBox[{"a", "[", "6", "]"}]}], "+", 
  RowBox[{
   FractionBox["16", "3"], " ", 
   RowBox[{"a", "[", "4", "]"}], " ", 
   RowBox[{"a", "[", "6", "]"}]}], "+", 
  RowBox[{"6", " ", 
   RowBox[{"a", "[", "5", "]"}], " ", 
   RowBox[{"a", "[", "6", "]"}]}], "+", 
  FractionBox[
   RowBox[{"36", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "6", "]"}], "2"]}], "11"], "+", 
  RowBox[{"2", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"a", "[", "7", "]"}]}], "+", 
  RowBox[{
   FractionBox["7", "2"], " ", 
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"a", "[", "7", "]"}]}], "+", 
  RowBox[{
   FractionBox["14", "3"], " ", 
   RowBox[{"a", "[", "3", "]"}], " ", 
   RowBox[{"a", "[", "7", "]"}]}], "+", 
  RowBox[{
   FractionBox["28", "5"], " ", 
   RowBox[{"a", "[", "4", "]"}], " ", 
   RowBox[{"a", "[", "7", "]"}]}], "+", 
  RowBox[{
   FractionBox["70", "11"], " ", 
   RowBox[{"a", "[", "5", "]"}], " ", 
   RowBox[{"a", "[", "7", "]"}]}], "+", 
  RowBox[{"7", " ", 
   RowBox[{"a", "[", "6", "]"}], " ", 
   RowBox[{"a", "[", "7", "]"}]}], "+", 
  FractionBox[
   RowBox[{"49", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "7", "]"}], "2"]}], "13"]}]], "Output",
 CellChangeTimes->{3.7338647266520643`*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"19586236-ca7f-485a-9d6c-3cd539d37777"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"snap", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"p", "[", "t", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "4"}], "}"}]}], "]"}], "^", "2"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.734106445255464*^9, 3.734106450566519*^9}, {
  3.734110048430087*^9, 3.734110051780388*^9}, {3.734110318961937*^9, 
  3.734110321871976*^9}, {3.73411044633602*^9, 3.7341104486864367`*^9}, {
  3.7341105311827517`*^9, 3.7341105342611513`*^9}, {3.734469505224968*^9, 
  3.734469518615555*^9}, {3.734469939767311*^9, 3.7344699398859167`*^9}, {
  3.7344701261586018`*^9, 3.7344701262451344`*^9}, {3.734470213774172*^9, 
  3.734470213868804*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"d97fec14-95c2-43cc-a0a2-a08e76cd9f49"],

Cell[BoxData[
 RowBox[{
  RowBox[{"576", " ", "T", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "2"]}], "+", 
  RowBox[{"2880", " ", 
   SuperscriptBox["T", "2"], " ", 
   RowBox[{"a", "[", "4", "]"}], " ", 
   RowBox[{"a", "[", "5", "]"}]}], "+", 
  RowBox[{"4800", " ", 
   SuperscriptBox["T", "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "5", "]"}], "2"]}], "+", 
  RowBox[{"5760", " ", 
   SuperscriptBox["T", "3"], " ", 
   RowBox[{"a", "[", "4", "]"}], " ", 
   RowBox[{"a", "[", "6", "]"}]}], "+", 
  RowBox[{"21600", " ", 
   SuperscriptBox["T", "4"], " ", 
   RowBox[{"a", "[", "5", "]"}], " ", 
   RowBox[{"a", "[", "6", "]"}]}], "+", 
  RowBox[{"25920", " ", 
   SuperscriptBox["T", "5"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "6", "]"}], "2"]}], "+", 
  RowBox[{"10080", " ", 
   SuperscriptBox["T", "4"], " ", 
   RowBox[{"a", "[", "4", "]"}], " ", 
   RowBox[{"a", "[", "7", "]"}]}], "+", 
  RowBox[{"40320", " ", 
   SuperscriptBox["T", "5"], " ", 
   RowBox[{"a", "[", "5", "]"}], " ", 
   RowBox[{"a", "[", "7", "]"}]}], "+", 
  RowBox[{"100800", " ", 
   SuperscriptBox["T", "6"], " ", 
   RowBox[{"a", "[", "6", "]"}], " ", 
   RowBox[{"a", "[", "7", "]"}]}], "+", 
  RowBox[{"100800", " ", 
   SuperscriptBox["T", "7"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "7", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.7341064394898787`*^9, 3.734106452013844*^9}, 
   3.734110057105865*^9, 3.734110328432435*^9, 3.7341104563667097`*^9, 
   3.734110535379717*^9, 3.734469469706443*^9, {3.7344695062978687`*^9, 
   3.7344695195623693`*^9}, 3.734469941081936*^9, 3.7344701268551693`*^9, 
   3.734470215063073*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"05d37d5a-356e-4d7b-985c-f628b6d3a153"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"column", "\[NotEqual]", "row"}], ",", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", "*", 
         RowBox[{"Coefficient", "[", 
          RowBox[{"snap", ",", 
           RowBox[{
            RowBox[{"a", "[", "row", "]"}], 
            RowBox[{"a", "[", "column", "]"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Coefficient", "[", 
         RowBox[{"snap", ",", 
          RowBox[{
           RowBox[{"a", "[", "row", "]"}], 
           RowBox[{"a", "[", "column", "]"}]}]}], "]"}]}], "]"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"column", ",", "0", ",", "degree"}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"row", ",", "0", ",", "degree"}], "}"}]}], "]"}], "//", 
  "CForm"}]], "Input",
 CellChangeTimes->{{3.734107703714435*^9, 3.734107759049973*^9}, {
  3.734107815606929*^9, 3.7341078435771933`*^9}, {3.734110019750413*^9, 
  3.734110088805032*^9}, {3.734110124236638*^9, 3.7341101257885313`*^9}, {
  3.73411032456221*^9, 3.7341103265359783`*^9}, {3.734110451072096*^9, 
  3.734110453630601*^9}, {3.7341105380385733`*^9, 3.734110544197564*^9}, {
  3.7344696544088697`*^9, 3.734469655494894*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"b6219106-6b51-4558-9f4c-e0b17565f297"],

Cell["\<\
List(List(0,0,0,0,0,0,0,0),List(0,0,0,0,0,0,0,0),List(0,0,0,0,0,0,0,0),List(0,\
0,0,0,0,0,0,0),
   List(0,0,0,0,576*T,1440*Power(T,2),2880*Power(T,3),5040*Power(T,4)),
   List(0,0,0,0,1440*Power(T,2),4800*Power(T,3),10800*Power(T,4),20160*Power(\
T,5)),
   List(0,0,0,0,2880*Power(T,3),10800*Power(T,4),25920*Power(T,5),50400*Power(\
T,6)),
   List(0,0,0,0,5040*Power(T,4),20160*Power(T,5),50400*Power(T,6),100800*\
Power(T,7)))\
\>", "Output",
 CellChangeTimes->{{3.734107723070681*^9, 3.7341077289149857`*^9}, 
   3.734107844602384*^9, {3.734110021306943*^9, 3.7341100897145*^9}, 
   3.7341101267328243`*^9, 3.734110331415419*^9, 3.734110458678781*^9, 
   3.734110545255496*^9, 3.734469474319203*^9, {3.734469513099801*^9, 
   3.734469523620797*^9}, 3.7344696565049343`*^9, 3.734469943799982*^9, 
   3.734470129223342*^9, 3.734470218459194*^9},
 CellLabel->
  "Out[19]//CForm=",ExpressionUUID->"aa560391-28a7-430f-b446-f011a0008df9"]
}, Open  ]]
},
WindowSize->{1057, 1128},
WindowMargins->{{86, Automatic}, {Automatic, 73}},
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 255, 6, 35, "Text",ExpressionUUID->"6ffa8bee-575b-4c59-ad18-6f206a50072b"],
Cell[816, 28, 654, 10, 31, "Input",ExpressionUUID->"356cba98-2e24-42df-bdf9-cb0765857e04"],
Cell[1473, 40, 319, 6, 35, "Text",ExpressionUUID->"3121a830-1fb5-4733-85a4-6e7e05289bcd"],
Cell[1795, 48, 965, 25, 55, "Input",ExpressionUUID->"d2e5df0a-b363-41a9-b457-24ba5f5c5928"],
Cell[2763, 75, 268, 6, 35, "Text",ExpressionUUID->"209055fd-8df3-409f-94e3-05091c2cddcd"],
Cell[3034, 83, 1263, 35, 55, "Input",ExpressionUUID->"3bc29877-a5f7-4cba-841b-3af64ae5142e"],
Cell[4300, 120, 301, 6, 35, "Text",ExpressionUUID->"1c26bc9f-ef89-4ae2-9f25-0c362d5fc98e"],
Cell[4604, 128, 1215, 31, 101, "Input",ExpressionUUID->"7a412217-12bd-4d64-9fcd-f5ae9399e381"],
Cell[CellGroupData[{
Cell[5844, 163, 162, 3, 31, "Input",ExpressionUUID->"5faf7154-b6c0-437a-aaec-87a7c994ee0f"],
Cell[6009, 168, 1672, 46, 173, "Output",ExpressionUUID->"60cb5da6-f3f9-4848-afbf-07311abada79"]
}, Open  ]],
Cell[7696, 217, 179, 3, 35, "Text",ExpressionUUID->"3501070b-bf99-427d-a321-4a3f9f8dc7ae"],
Cell[CellGroupData[{
Cell[7900, 224, 1080, 27, 78, "Input",ExpressionUUID->"41dcec2b-b697-4fd3-a1fb-960178696f98"],
Cell[8983, 253, 772, 24, 37, "Output",ExpressionUUID->"e02e5fe8-5e14-4c8c-920c-8f600878665f"]
}, Open  ]],
Cell[9770, 280, 178, 3, 35, "Text",ExpressionUUID->"f432ffec-d8f8-4326-965a-8aa89ed1b4fb"],
Cell[CellGroupData[{
Cell[9973, 287, 588, 15, 78, "Input",ExpressionUUID->"c312f41c-a559-427c-b23f-4fde61e4c303"],
Cell[10564, 304, 1992, 66, 123, "Output",ExpressionUUID->"98eb70a3-1faf-4cca-8ab9-52a411abaf68"]
}, Open  ]],
Cell[12571, 373, 180, 3, 35, "Text",ExpressionUUID->"4faec8e5-8081-4f26-84ae-fec9cd71eb1a"],
Cell[CellGroupData[{
Cell[12776, 380, 343, 8, 31, "Input",ExpressionUUID->"65a1e25b-4d9e-42a4-942e-73f4cae95ac0"],
Cell[13122, 390, 1023, 31, 53, "Output",ExpressionUUID->"20263487-20f7-4eeb-ac74-76f76d485f7e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14182, 426, 739, 19, 31, "Input",ExpressionUUID->"d9b8cd25-7887-4763-8583-a9bcf6ca8349"],
Cell[14924, 447, 4572, 148, 152, "Output",ExpressionUUID->"a0b997d5-bfc0-4a71-9e7d-99093c78990b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19533, 600, 164, 3, 31, "Input",ExpressionUUID->"90e073cc-2312-4089-9c23-1cc6293e396b"],
Cell[19700, 605, 4562, 154, 301, "Output",ExpressionUUID->"8b19519c-bcab-49a9-a101-98283ba15a8f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24299, 764, 679, 15, 31, "Input",ExpressionUUID->"1bff4f71-8dd1-4982-be34-f744259aae69"],
Cell[24981, 781, 353, 5, 35, "Output",ExpressionUUID->"d9ba10ea-f920-4b9e-81f0-34dfa736de49"]
}, Open  ]],
Cell[25349, 789, 178, 3, 35, "Text",ExpressionUUID->"9b332c64-3353-4d4a-8709-c90db453f331"],
Cell[CellGroupData[{
Cell[25552, 796, 704, 16, 31, "Input",ExpressionUUID->"07c186da-0fd2-4fb1-a9e2-58ddcce1a86a"],
Cell[26259, 814, 679, 17, 37, "Output",ExpressionUUID->"e23efc2a-30cf-4de6-9290-e0a9ba62208f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26975, 836, 580, 14, 31, "Input",ExpressionUUID->"a62c6189-fb2e-48a0-b163-45ca657f9030"],
Cell[27558, 852, 1434, 44, 59, "Output",ExpressionUUID->"56878f9f-023e-4e9a-abc9-0c2ab2660d1d"]
}, Open  ]],
Cell[29007, 899, 154, 3, 31, "Input",ExpressionUUID->"1ffd2989-958e-423d-a914-059b25ab5d43"],
Cell[CellGroupData[{
Cell[29186, 906, 890, 21, 31, "Input",ExpressionUUID->"8fc69d1a-fc20-4786-afc7-fe166cb8a4c4"],
Cell[30079, 929, 2202, 34, 41, "Message",ExpressionUUID->"9e553d19-520f-4cc6-b095-3a84e06138d3"],
Cell[32284, 965, 4521, 134, 156, "Output",ExpressionUUID->"4abbb112-4faa-436d-b68d-ab300b66ff27"]
}, Open  ]],
Cell[36820, 1102, 173, 3, 31, "Input",ExpressionUUID->"6756f914-a5bd-4eb4-9597-05655a694fd3"],
Cell[36996, 1107, 148, 3, 35, "Text",ExpressionUUID->"b3dfe17c-fa40-462d-a97b-93fc7e4750ac"],
Cell[CellGroupData[{
Cell[37169, 1114, 459, 12, 31, "Input",ExpressionUUID->"f00ffd47-a6c8-49bb-b331-7ac5a2f4e961"],
Cell[37631, 1128, 1145, 33, 62, "Output",ExpressionUUID->"8fa86029-3c1d-4f64-820b-ce863e5d0f5e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38813, 1166, 695, 13, 154, "Input",ExpressionUUID->"68ac6a0b-8177-45e3-8a8f-ac353bdf72c9"],
Cell[39511, 1181, 1272, 36, 82, "Output",ExpressionUUID->"28741692-28ee-4061-b4bd-05947770da03"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40820, 1222, 731, 18, 31, "Input",ExpressionUUID->"3eb52bad-613e-453a-9ad8-e69929065159"],
Cell[41554, 1242, 223, 3, 35, "Output",ExpressionUUID->"8c95233c-1a7b-4e3d-b9d7-de3634e5255a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41814, 1250, 225, 3, 31, "Input",ExpressionUUID->"17afaeab-859f-493e-9900-6c1585f4639f"],
Cell[42042, 1255, 153, 2, 35, "Output",ExpressionUUID->"a8f2aa47-46cf-4a0e-abb9-5dbf570a12d8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42232, 1262, 228, 3, 31, "Input",ExpressionUUID->"7c038bec-0cdd-48f7-93e3-1d59d66cc27d"],
Cell[42463, 1267, 152, 2, 35, "Output",ExpressionUUID->"c9b4f1f4-b342-4fcc-bf8e-a64b4e10958b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42652, 1274, 328, 6, 31, "Input",ExpressionUUID->"7c60f92f-0c80-413d-a099-abbb936b8817"],
Cell[42983, 1282, 1761, 48, 173, "Output",ExpressionUUID->"1586a633-b3c9-49d3-b46d-303027ea6840"]
}, Open  ]],
Cell[44759, 1333, 154, 3, 31, "Input",ExpressionUUID->"394e6560-c2ba-4f06-84b8-d51b5eb2c9ca"],
Cell[CellGroupData[{
Cell[44938, 1340, 294, 5, 31, "Input",ExpressionUUID->"ec27800f-f804-4572-8bdc-e0ad573654c7"],
Cell[45235, 1347, 152, 2, 35, "Output",ExpressionUUID->"547a8c5d-f328-4d9a-9f9f-96ce8ac570cd"]
}, Open  ]],
Cell[45402, 1352, 785, 22, 31, "Input",ExpressionUUID->"a1e29bc7-4fc7-403d-82c8-03999a30d020"],
Cell[CellGroupData[{
Cell[46212, 1378, 1107, 20, 31, "Input",ExpressionUUID->"d5597c04-b12b-465d-9901-8fb6f7b27725"],
Cell[47322, 1400, 1052, 20, 86, "Output",ExpressionUUID->"b0b81697-5ea5-476e-af71-c1370270e373"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48411, 1425, 231, 4, 31, "Input",ExpressionUUID->"0872e26a-92b1-4c5b-8334-d73d9c219b58"],
Cell[48645, 1431, 1701, 48, 94, "Output",ExpressionUUID->"5c5db12a-0be3-4ee8-85f5-bb330e1b25a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50383, 1484, 296, 6, 31, "Input",ExpressionUUID->"b47fbed1-2a83-4da7-87ed-71ef5d9cc03c"],
Cell[50682, 1492, 154, 2, 35, "Output",ExpressionUUID->"8e87c685-f291-4f54-a2da-4b27682fc4cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50873, 1499, 455, 12, 31, "Input",ExpressionUUID->"289ee813-a62e-4895-8dba-c2e69a412339"],
Cell[51331, 1513, 3244, 102, 152, "Output",ExpressionUUID->"19586236-ca7f-485a-9d6c-3cd539d37777"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54612, 1620, 888, 19, 31, "Input",ExpressionUUID->"d97fec14-95c2-43cc-a0a2-a08e76cd9f49"],
Cell[55503, 1641, 1743, 46, 62, "Output",ExpressionUUID->"05d37d5a-356e-4d7b-985c-f628b6d3a153"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57283, 1692, 1446, 34, 101, "Input",ExpressionUUID->"b6219106-6b51-4558-9f4c-e0b17565f297"],
Cell[58732, 1728, 945, 18, 126, "Output",ExpressionUUID->"aa560391-28a7-430f-b446-f011a0008df9"]
}, Open  ]]
}
]
*)

